<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>{{ block "title" . }}{{ .Title }}{{ end }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; font-src 'self' https://cdn.jsdelivr.net; connect-src 'self';">
  
  <!-- Favicon -->
  <link rel="icon" href="{{ "favicon.ico" | absURL }}">
  
  <!-- Preload critical resources -->
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" as="style">
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" as="style">
  {{ $mainCSS := resources.Get "css/main.css" | minify | fingerprint }}
  {{ $enhancedCSS := resources.Get "css/enhanced.css" | minify | fingerprint }}
  <link rel="preload" href="{{ $mainCSS.RelPermalink }}" as="style">
  <link rel="preload" href="{{ $enhancedCSS.RelPermalink }}" as="style">
  
  <!-- Bootstrap icons - Actualizado a la versión 1.11.3 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  
  <!-- Bootstrap CSS (CDN optimizado) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  
  <!-- CSS personalizados minificados -->
  <link rel="stylesheet" href="{{ $mainCSS.RelPermalink }}" integrity="{{ $mainCSS.Data.Integrity }}">
  <link rel="stylesheet" href="{{ $enhancedCSS.RelPermalink }}" integrity="{{ $enhancedCSS.Data.Integrity }}">
  
  <!-- Critical CSS (inline) -->
  <style>
    /* static/css/critical.css */
    :root {
      --font-family-heading: 'Poppins', sans-serif;
      --font-family-paragraph: Helvetica, sans-serif;
      --gradient-color-start: #01020e;
      --gradient-color-end: #00204a;
      --text-color: #cdcdcd;
      --highlight-color: #00a2e8; /* Añadida por si se usa en active links del header */
    }

    body {
      background: linear-gradient(135deg, var(--gradient-color-start), var(--gradient-color-end));
      background-size: 200% 200%;
      font-family: var(--font-family-paragraph);
      color: var(--text-color);
      margin: 0;
      overflow-x: hidden;
    }

    /* Header Styles (from header.css) */
    .header {
      background: rgba(6, 69, 170, 0.869);
      backdrop-filter: blur(80px);
      -webkit-backdrop-filter: blur(80px);
      height: 64px;
      position: fixed;
      width: 100%;
      font-family: sans-serif; /* Overrides var(--font-family-paragraph) for header */
      z-index: 3;
      top: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      color: #ffffff; /* Overrides var(--text-color) for header */
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.5);
    }

    .header-logo {
      font-size: 30px;
      font-weight: bold;
      line-height: 44px; /* Adjusted for header height on mobile */
    }

    .nav {
      width: 90%;
      margin: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .nav a {
      text-decoration: none;
      color: #ffffff;
      border-radius: 6px;
    }

    .nav-menu {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      height: 64px;
      gap: 0.5rem;
    }

    .nav-menu li {
      margin: auto;
      font-size: 18px;
    }

    .nav-menu-link:hover {
      text-decoration: none;
      color: #ffffff;
    }

    .active > .nav-menu-link {
      background-color: #034574;
    }

    .nav-toggle {
      color: white;
      background: none;
      border: none;
      font-size: 30px;
      padding: 0 20px;
      line-height: 44px; /* Adjusted for header height on mobile */
      cursor: pointer;
      display: none;
    }

    @media (max-width: 768px) {
      .header {
        height: 44px;
      }

      .header-logo {
        padding: 0 8%;
        line-height: 44px;
      }

      .nav {
        width: 100%;
      }

      .nav-menu {
        background-color: #2c3e50;
        flex-direction: column;
        align-items: center;
        margin: 0;
        position: fixed;
        top: 44px;
        width: 20rem;
        padding: 0;
        height: calc(100vh - 44px);
        overflow-y: auto;
        /* transition: left 0.3s;  Moved to enhanced.css */
        left: 100%;
      }

      .nav > ul > li > a {
        text-align: center;
      }

      .nav-menu > li {
        font-size: 25px;
        line-height: 60px;
        border-radius: 13px;
        margin: 0 auto;
        width: 100%;
      }

      .nav-menu-link:hover {
        text-decoration: none;
        color: #000000;
        /* transition: 0.2s; Moved to enhanced.css */
      }

      .active > .nav-menu-link {
        background: none;
        color: black;
        font-weight: 800;
        font-size: larger;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
      }

      .nav-menu > .active {
        width: 100%;
        border-radius: 0;
        background-color: deepskyblue;
      }

      .nav-toggle {
        display: block;
      }

      .nav-menu_visible {
        left: calc(100% - 320px);
      }

      .nav-toggle:focus:not(:focus-visible) {
        outline: none;
      }
      .nav-menu.no-transition {
        transition: none !important;
      }
    }

    @media (max-width: 320px) {
      .nav-menu {
        width: 100vw;
      }
      .nav-menu_visible {
        left: 0; /* Ensures it takes full screen width */
      }
    }

    /* Styles for view toggling (from base.css, transitions moved to enhanced.css) */
    .preload #gridView,
    .preload #listView { visibility: hidden !important; }

    html.grid-view #gridView,
    body.grid-view #gridView {
      display: block !important;
      opacity: 1;
      transform: translateY(0);
    }

    html.grid-view #listView,
    body.grid-view #listView {
      display: none !important;
      opacity: 0;
      transform: translateY(10px);
    }

    html.list-view #listView,
    body.list-view #listView {
      display: flex !important;
      opacity: 1;
      transform: translateY(0);
    }

    html.list-view #gridView,
    body.list-view #gridView {
      display: none !important;
      opacity: 0;
      transform: translateY(10px);
    }

    /* Default visibility for views when no specific class is set */
    #gridView, #listView {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* Default to list view when no class is specifically set */
    body:not(.grid-view):not(.list-view) #listView,
    html:not(.grid-view):not(.list-view) #listView {
      display: flex !important;
    }
    
    body:not(.grid-view):not(.list-view) #gridView,
    html:not(.grid-view):not(.list-view) #gridView {
      display: none !important;
    }

    /* Asegurar que el contenedor no esté oculto */
    .container, .row, .col {
      display: block !important;
      visibility: visible !important;
    }
    
    /* Forzar flexbox para las filas */
    .row {
      display: flex !important;
      flex-wrap: wrap;
    }
    
    #listView {
      display: flex !important;
      flex-direction: column;
    }

    /* Estilos críticos para tarjetas y layout de posts/proyectos */
    .card {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 0.5rem;
      transition: transform 0.2s ease-in-out;
    }
    
    .card:hover {
      transform: translateY(-2px);
    }
    
    .card-img-top {
      height: 200px;
      object-fit: cover;
      border-top-left-radius: 0.5rem;
      border-top-right-radius: 0.5rem;
    }
    
    .card-body {
      padding: 1rem;
      color: var(--text-color);
    }
    
    .card-title {
      color: #ffffff !important;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .card-text {
      color: #cdcdcd !important;
      line-height: 1.5;
    }
    
    .text-muted {
      color: #b0b0b0 !important;
    }
    
    /* Asegurar visibilidad del texto */
    .card-body * {
      color: #ffffff !important;
    }
    
    .card-body .text-muted,
    .card-body small {
      color: #b0b0b0 !important;
    }
    
    .card-body .card-text {
      color: #cdcdcd !important;
    }
    
    .badge {
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
    }
    
    .bg-primary {
      background-color: var(--highlight-color) !important;
    }
    
    /* Layout específico para vista lista */
    #listView .card {
      flex-direction: row !important;
      max-height: 150px;
    }
    
    #listView .card img {
      width: 200px;
      height: 150px;
      flex-shrink: 0;
    }
    
    /* Responsive grid */
    .row-cols-1 > * { width: 100%; }
    .row-cols-sm-2 > * { width: 50%; }
    .row-cols-md-3 > * { width: 33.333333%; }
    .row-cols-lg-4 > * { width: 25%; }
    
    @media (min-width: 576px) {
      .row-cols-sm-2 > * { width: 50%; }
    }
    
    @media (min-width: 768px) {
      .row-cols-md-3 > * { width: 33.333333%; }
    }
    
    @media (min-width: 992px) {
      .row-cols-lg-4 > * { width: 25%; }
    }

    html.list-view #gridView,
    body.list-view #gridView {
      display: none !important;
      opacity: 0;
      transform: translateY(10px);
    }

    /* Basic styles for hero section if it's the carousel (from utilities.css) */
    #carouselExampleCaptions {
      margin-top: 64px; /* Adjusted for fixed header */
    }
    @media (max-width: 768px) {
      #carouselExampleCaptions {
        margin-top: 44px; /* Adjusted for fixed header on mobile */
      }
    }
    /* Basic structure for carousel items to be visible (from components.css) */
    .carousel-item {
      /* Basic display properties, detailed styling in main.css or enhanced.css */
      display: none; /* Hidden by default, JS will manage active item */
      position: relative;
      width: 100%;
      /* transition: transform .6s ease-in-out; Moved to enhanced.css */
    }
    .carousel-item.active {
      display: block;
    }
    .carousel-item img { /* Basic styling for image within carousel */
      height: 300px; /* As per components.css, can be refined */
      width: 100%;
      object-fit: cover;
    }
    @media (max-width: 768px) {
      .carousel-item img {
        height: 170px; /* As per responsive.css */
      }
    }
  </style>

  <!-- Highlight.js CSS (cargar si Chroma no está habilitado o si se prefiere un tema de hljs) -->
  {{ if not .Site.Params.enableChromaSyntax }}
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"></noscript>
  {{ end }}
  <!-- Chroma Syntax CSS (si está habilitado en config.toml) -->
  {{ if .Site.Params.enableChromaSyntax }}
    <link rel="stylesheet" href="{{ "/css/chroma-syntax.css" | relURL }}">
  {{ end }}

  <!-- Meta tags para SEO y redes sociales -->
  {{/* La lógica de $pageTitle se moverá directamente a las meta tags */}}
  <meta name="description" content="{{ with .Params.description }}{{ . }}{{ else }}{{ if .IsPage }}{{ .Summary | plainify | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
  <link rel="canonical" href="{{ .Permalink }}">

  {{ block "meta_tags" . }}
    <!-- Open Graph -->
    <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ printf "%s | %s" .Title .Site.Title }}{{ end }}">
    {{ $ogType := "website" }}
    {{ if .IsPage }}{{ $ogType = "article" }}{{ end }}
    <meta property="og:type" content="{{ $ogType }}">
    <meta property="og:url" content="{{ .Permalink }}">
    <meta property="og:site_name" content="{{ .Site.Title }}">
    {{ $ogDescription := .Site.Params.description }} {{/* Default a la descripción del sitio */}}
    {{ if .IsPage }}
      {{ $ogDescription = .Summary | plainify | truncate 160 }}
    {{ end }}
    {{ with .Params.description }} {{/* La descripción del Front Matter de la página tiene prioridad */}}
      {{ $ogDescription = . }}
    {{ end }}
    <meta property="og:description" content="{{ $ogDescription }}">
    
    {{ $ogImage := "" }}
    {{ if .Params.image }}
      {{ $ogImage = .Params.image | absURL }}
    {{ else if .Site.Params.logo }}
      {{ $ogImage = .Site.Params.logo | absURL }}
    {{ end }}
    {{ with $ogImage }}<meta property="og:image" content="{{ . }}">{{ end }}
    
    {{ with .Site.LanguageCode }}<meta property="og:locale" content="{{ . }}">{{ end }}

    <!-- Twitter Card -->
    {{ $twitterCardType := "summary" }}
    {{ if $ogImage }}{{ $twitterCardType = "summary_large_image" }}{{ end }}
    <meta name="twitter:card" content="{{ $twitterCardType }}">
    <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ printf "%s | %s" .Title .Site.Title }}{{ end }}">
    <meta name="twitter:description" content="{{ $ogDescription }}">
    {{ with $ogImage }}<meta name="twitter:image" content="{{ . }}">{{ end }}
    {{ with .Site.Params.twitter_handle }}
      <meta name="twitter:site" content="@{{ . }}">
      <meta name="twitter:creator" content="@{{ . }}">
    {{ end }}
  {{ end }}
  
  <!-- Script para evitar el parpadeo de vistas -->
  <script>
    /* Evitar FOUC: ocultamos mientras decidimos */
    document.documentElement.classList.add('preload');
    
    (function() {
      const pref = localStorage.getItem('vistaPreferida') || 'list';  // 'grid' | 'list'
      
      // Aplicamos clases tanto al HTML como al body para máxima compatibilidad
      if (pref === 'grid') {
        document.documentElement.classList.add('grid-view');
        document.documentElement.classList.remove('list-view');
        document.body.classList.add('grid-view');
        document.body.classList.remove('list-view');
      } else {
        document.documentElement.classList.add('list-view');
        document.documentElement.classList.remove('grid-view');
        document.body.classList.add('list-view');
        document.body.classList.remove('grid-view');
      }
    })();
  </script>
</head>

{{ $themeStyle := slice "" }}
{{ if eq .Site.Params.addFrame true }}{{ $themeStyle = $themeStyle | append "frame" }}{{ end }}

<body class="d-flex flex-column min-vh-100 {{ block "body_classes" . }}{{ end }}">
  <!--<body class="d-flex flex-column min-vh-100 preload"> Es de la pag ejemplo (no funciona con este proyecto)-->
  <!-- Header -->
  {{ partial "header.html" . }}
  
  <!-- Main content  Antigua vercion-->
  {{/*  <main class="flex-grow-1">
    {{ block "main" . }}{{ end }}
  </main>  */}}
    {{ block "carusel" . }}
    {{ end }}
    <main class="d-flex flex-fill justify-content-center align-items-stretch m-0 p-0">
      <div class="mid-wrapper d-flex flex-column flex-fill shadow w-100 text-white">
        {{ block "main" . }}
        {{ end }}
      </div>
    </main>
  <!-- Footer -->
  {{ block "footer" . }}
    {{ partial "footer.html" . }}
  {{ end }}
  <!-- JavaScript -->
  <!-- Highlight.js JS (cargar de forma asíncrona) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" async defer></script>
  <!-- Opcional: Cargar lenguajes específicos si es necesario, ej:
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js" async defer></script>
  -->
  <script>
    // Inicializar highlight.js después de que se cargue
    // Esto puede ser necesario si el script se carga 'defer' y el DOMContentLoaded ya pasó.
    // O si se quiere asegurar que hljs.highlightAll() o hljs.highlightElement() se llamen después.
    // Por ahora, el script 'static/js/scripts.js' maneja la inicialización en DOMContentLoaded.
  </script>

  <!-- Bootstrap 5 Bundle (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous" defer></script>
  
  <!-- JavaScript personalizado minificado -->
  {{ $customJS := resources.Get "js/scripts.js" | minify | fingerprint }}
  <script src="{{ $customJS.RelPermalink }}" integrity="{{ $customJS.Data.Integrity }}" defer></script>
  
  <!-- Custom footer JavaScript -->
  {{ block "footer_js" . }}{{ end }}
</body>





</html>